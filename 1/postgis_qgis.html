<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<title>Визуализация данных PostGIS в настольном ГИС приложении</title>

<xmp theme="united" style="display:none;">

Чтобы просмотреть, что из себя представляют загруженные в БД слои, откроем
их в настольном клиенте QGIS. Если у вас не установлен QGIS, то его
можно установить с помощью все того же инсталлятора OSGeo4W
(отметив пакет *Desktop &#10139; qgis-dev*). Процесс установки QGIS в Windows
описан в статье [Установка QGIS/GRASS с помощью OSGeo4W](http://gis-lab.info/qa/qgis-osgeo4w.html).
Описание способов установки для различных ОС приведено [здесь](http://qgis.org/ru/site/forusers/download.html).

1. Запустите QGIS и в меню *Слой* выберите пункт *Добавить слой PostGIS*;
2. Нажмите кнопку *Создать* и в открывшемся окне введите параметры
   PostGIS-соединения:

   * **Имя** - произвольная строка по которой вы сможете идентифицировать
     данное PostGIS-соединение в списке доступных соединений;
   * **Узел** - адрес хоста на котором запущен PostgreSQL;
   * **Порт** - порт, который прослушивает PostgfeSQL (по умолчанию 5432);
   * **База данных** - `dbfrecom`;
   * **Пользователь** - `pguser`;
   * **Пароль** - `topsecret`;

   Отметьте пункты *Сохранить пользователя* и *Сохранить пароль* и нажмите OK:

   ![][01-qgis-01]

3. В открывшемся окне нажмите кнопку *Подключиться*, после чего вы увидите
   список слоёв PostGIS, доступных на сервере.

   ![][01-qgis-02]

4. Отметьте слои, которые вы желаете отобразить и нажмите кнопку *Добавить*.
   Примерно так (с настроенной символикой) будут выглядеть слои `water_polygon`
   и `building_polygon`:

   ![][01-qgis-03]

Отображение PostGIS-слоёв, построенных на базе произвольных запросов
--------------------------------------------------------------------

Для выполнения данной задачи выберите
*База данных &#10139; Менеджер БД &#10139; Менеджер БД*.

![][01-qgis-04]

В открывшемся окне выберите свою базу данных и нажмите кнопку *SQL*.
Введите следующий запрос и нажмите *Выполнить (F5)*:

    SELECT ogc_fid, ST_Buffer(ST_Transform(wkb_geometry, 3857), 5) AS geom, name FROM building_polygon LIMIT 100;

![][01-qgis-07]

Отметьте пункт *Загрузить как новый слой* и укажите поле первичного
ключа и геометрии, после чего нажмите *Загрузить*.

В результате чего будут запрошены геометрии, перепроецированные
в новую проекцию и с построенным пятиметровым буфером. Операции по
перепроецированию и построению буфера выполняются на стороне сервера.

![][01-qgis-05]

Если поверх этого слоя отобразить оригинальные геометрии (включив
в QGIS преобразование координат *на лету* в проекцию 3857), то это
будет выглядеть следующим образом:

![][01-qgis-06]

[01-qgis-01]: ../img/01-qgis-01.png
[01-qgis-02]: ../img/01-qgis-02.png
[01-qgis-03]: ../img/01-qgis-03.png
[01-qgis-04]: ../img/01-qgis-04.png
[01-qgis-05]: ../img/01-qgis-05.png
[01-qgis-06]: ../img/01-qgis-06.png
[01-qgis-07]: ../img/01-qgis-07.png

</xmp>
<script src="../strapdown/v/0.1/strapdown.js"></script>
</html>
